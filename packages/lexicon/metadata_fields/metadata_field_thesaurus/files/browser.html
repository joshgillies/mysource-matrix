<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
	<head>
		<title>Browser</title>
		<style type="text/css">
			html,body {
				height:100%;
				margin:0px;
				padding:0px
			}
			.sq_table_terms_list_del {
				/* overflow: hidden; */
			}
			.sq_table_terms_list_del div {
				text-align:left;
				font: 8pt "Lucida Grande","MS Sans Serif";
				padding-left: 3pt;
				border-bottom: solid 1px #EEEEEE;
				color:#DDDDDD;
			}
			.sq_table_terms_list {
				/* overflow: hidden; */
				width: 0px;
				width:75px;
				height: 180px;
				background-color: eee;
			}

			.sq_table_terms_list div {
				text-align:left;
				font: 8pt "Lucida Grande","MS Sans Serif";
				cursor: default;
				padding-left: 3pt;
				border-bottom: solid 1px #EEEEEE;
			}
			.selected {
				background-color: #BDBDFF
			}
			.selectedgroup {
				background-color: #DFDFFF
			}
			body {
				overflow-y: hidden;
				background: #fff
			}
		</style>
		<script type="text/javascript">
		//<!--
			var GlobalList = Array();
			var List = Array();
			var Selected = -1;
			var ClickedID = 0;
			var ClickedTime = null;
			var Browser = null;
			var fade = 50;
			var scrolltime = null;


			function init()
			{
				Browser = parent.Browser;
				if (typeof Browser == "undefined" || Browser == null) return;
				if (Browser.loadInitialList) {
					Browser.loadInitialList(parent.document.getElementById(Browser.inputname).value);
				}
			}


			function addList(list, selected)
			{
				GlobalList.push(list);
				List = list;
				Selected = selected;
				tr = document.getElementById("Container");
				td = document.createElement("td");
				tr.appendChild(td);
				td.setAttribute("id", "td" + GlobalList.length);
				td.setAttribute("valign", "top");

				html = '<div class="sq_table_terms_list" id="list' + GlobalList.length + '">' + "" + '</div>';
				document.getElementById("td" + GlobalList.length).innerHTML = html;
				document.getElementById('list' + GlobalList.length).innerHTML = getTableList();
				var width = document.getElementById("Container").clientWidth;

				for (var i = 1; i < GlobalList.length; i++) {
					var div = document.getElementById("list" + i);
					div.style.MozOpacity = fade/100;
					div.style.opacity = fade/100;
					div.style.filter= 'alpha(opacity=' + fade + ')';
				}
				fadeIn(GlobalList.length, 100);
				Scroll(200, 0);

			}


			function delList()
			{
				if (GlobalList.length == 0) return;
				td = document.getElementById("td" + GlobalList.length);
				GlobalList.pop();
				tr = document.getElementById("Container");
				tr.removeChild(td);
				var div = document.getElementById("list" + GlobalList.length);
				div.style.MozOpacity = 1;
				div.style.opacity = 1;
				div.style.filter= 'alpha(opacity= 100)';
			}


			function Scroll(width, swidth)
			{
				clearTimeout(scrolltime);
				if (width <= swidth) {
					return;
				}
				window.scrollBy(5,0);
				swidth += 5;
				scrolltime = setTimeout("Scroll(" + width + ", " + swidth + ")",1);

			}


			function getTableList()
			{
				var list = List;
				var selected = Selected;
				if (list.length != 2) return "Error";
				var count = list[0].length;
				var gid = GlobalList.length;

				var out = '<span class="sq_table_terms_list">';
				for(var j = 0;j < count;j++) {
					out += '<div><img src="' + Browser.imagespath + '/minus.gif" onclick="toggleGroup(this,\'group' + gid + '_' + j + '\')"> <b>' + list[0][j] + '</b></div><span id="group' + gid + '_' + j + '" style="display:block">';
					for(var i = 0;i < list[1][j].length;i++) {
						if (i==selected) select = 'selected';
						else select = '';
						out += '<div id="td' + (gid - 1) + 'g' + j + 'i' + i + '" '+
							'class="' + select + '" onclick="itemClick(this.id)" ondblclick="itemDblClick(this.id)">' + list[1][j][i] + '</div>';
					}
					out += '</span>';
				}
				out += '</span>';
				return out;

			}


			function toggleGroup(img, id)
			{
				var display = document.getElementById(id).style.display;
				if (display == "block") {
					document.getElementById(id).style.display = "none";
					img.src = Browser.imagespath + "/plus.gif"
				} else {
					document.getElementById(id).style.display = "block";
					img.src = Browser.imagespath + "/minus.gif"
				}
			}


			function refreshHeight()
			{
				var height = (typeof window.innerHeight == "undefined")?document.documentElement.clientHeight:window.innerHeight;
				for (var i = 1;i <= GlobalList.length;i++)
					if (document.getElementById("list" + i) != null)
						document.getElementById("list" + i).style.height = (height - 20) + "px";
			}


			function itemClick(id)
			{
				if (ClickedID == 0 || (ClickedID != 0 && id != 'X')) {
					ClickedID = id;

					var gid = id.substring(2, id.indexOf("g")) * 1;
					var jid = id.substring(id.indexOf("g") + 1, id.indexOf("i")) * 1;
					var lid = id.substring(id.indexOf("i") + 1) * 1;

					//just in case...
					if (id == 'X') return;

					for (var j = 0; j < GlobalList[gid][0].length; j++) {
						var i = 0;
						var group = null;
						while (document.getElementById("td" + gid + "g" + j + "i" + i) != null) {
							if (i == lid && j == jid) {
								document.getElementById("td" + gid + "g" + j + "i" + i).className = "selected";
								group = document.getElementById("td" + gid + "g" + j + "i" + i).parentNode.previousSibling;
							}
							else {
								document.getElementById("td" + gid + "g" + j + "i" + i).className = "";
								document.getElementById("td" + gid + "g" + j + "i" + i).parentNode.previousSibling.className = "";
							}
							i++;
						}
						if (group != null) group.className = "selectedgroup";
					}

					ClickedTime = setTimeout("itemClick('X')", 1);
					return;
				} else {
					id = ClickedID;
					ClickedID = 0;
					clearTimeout(ClickedTime);
				}

				var gid = id.substring(2, id.indexOf("g")) * 1;
				var jid = id.substring(id.indexOf("g") + 1, id.indexOf("i")) * 1;
				var lid = id.substring(id.indexOf("i") + 1) * 1;
				var x = getOffset();
				fadeOut(gid, 0, GlobalList[gid][1][jid][lid]);
			}


			var fadeout = null;
			function fadeOut(gid, fadeval, entity)
			{
				clearTimeout(fadeout);
				//if (fadeval <= 0 || gid == GlobalList.length - 1) {
					while (GlobalList.length > gid + 1) delList();
					Browser.loadListByEntity(entity);
					return;
				//}
				/*for (var i=gid + 2; i < GlobalList.length + 1; i++) {
					div = document.getElementById("list" + i);
					div.className = "sq_table_terms_list_del";
					div.style.overflow = "hidden";
					div.style.width = fadeval + "px";
				}
				fadeval -= 5;
				fadeout = setTimeout("fadeOut("+gid+", "+fadeval+", '"+entity+"')", 1);*/

			}


			var fadein = null;
			function fadeIn(gid, fadeval)
			{
				clearTimeout(fadein);
				//if (fadeval >= 100) {
					div = document.getElementById("list" + gid);
					div.style.width = "100px";
					div.style.overflow = "auto";
					return;
				//}
				/*div = document.getElementById("list" + gid);
				div.style.width = fadeval + "px";
				fadeval += 10;
				fadein = setTimeout("fadeIn("+gid+", "+fadeval+")", 1);*/

			}


			function itemDblClick(id)
			{
				clearTimeout(ClickedTime);
				ClickedID = 0;
				var gid = id.substring(2, id.indexOf("g")) * 1;
				var jid = id.substring(id.indexOf("g") + 1, id.indexOf("i")) * 1;
				var lid = id.substring(id.indexOf("i") + 1) * 1;
				Browser.receiveString(GlobalList[gid][1][jid][lid]);
			}

			function getOffset()
			{
				var x;
				if (self.pageXOffset)
				{
					x = self.pageXOffset;
				}
				else if (document.documentElement && document.documentElement.scrollLeft)
				{
					x = document.documentElement.scrollLeft;
				}
				else if (document.body)
				{
					x = document.body.scrollLeft;
				}

				return x;
			}
			//-->
		</script>
	</head>
	<body onload="init()" leftmargin="0" topmargin="0" marginheight="0" marginwidth="0">
		<table border="0" cellpadding="0" cellspacing="0" id="TableContainer" class="none">
			<tr id="Container"></tr>
		</table>
	</body>
</html>
