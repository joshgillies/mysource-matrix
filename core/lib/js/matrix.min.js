
var VAR_SERIALISE_STRING_ESCAPE_CHAR=String.fromCharCode(27);var VAR_SERIALISE_STRING_ESCAPE_FROM_LIST=["\r",'>',"\n",'/','<'];var VAR_SERIALISE_STRING_ESCAPE_TO_LIST=[VAR_SERIALISE_STRING_ESCAPE_CHAR+'r',VAR_SERIALISE_STRING_ESCAPE_CHAR+'>',VAR_SERIALISE_STRING_ESCAPE_CHAR+'n',VAR_SERIALISE_STRING_ESCAPE_CHAR+'/',VAR_SERIALISE_STRING_ESCAPE_CHAR+'<'];var VAR_SERIALISE_STRING_ESCAPE_CHAR_REG_EXP=new RegExp(VAR_SERIALISE_STRING_ESCAPE_CHAR,'g');var VAR_SERIALISE_STRING_ESCAPE_FROM_LIST_REG_EXP=new Array(VAR_SERIALISE_STRING_ESCAPE_FROM_LIST.length);var VAR_SERIALISE_STRING_ESCAPE_TO_LIST_REG_EXP=new Array(VAR_SERIALISE_STRING_ESCAPE_TO_LIST.length);for(var i=0;i<VAR_SERIALISE_STRING_ESCAPE_FROM_LIST.length;i++){VAR_SERIALISE_STRING_ESCAPE_FROM_LIST_REG_EXP[i]=new RegExp(VAR_SERIALISE_STRING_ESCAPE_FROM_LIST[i],'g');VAR_SERIALISE_STRING_ESCAPE_TO_LIST_REG_EXP[i]=new RegExp(VAR_SERIALISE_STRING_ESCAPE_TO_LIST[i],'g');}
function var_serialise(value)
{return _var_serialise(value,'');}
function _var_serialise(value,indent)
{var str="";var type=gettype(value).toLowerCase();switch(type){case"string":if(VAR_SERIALISE_STRING_ESCAPE_CHAR_REG_EXP.test(value)){alert(js_translate('data_contains_escape_character',VAR_SERIALISE_STRING_ESCAPE_CHAR.charCodeAt(0)));value=value.replace(VAR_SERIALISE_STRING_ESCAPE_CHAR_REG_EXP,'');}
for(var i=0;i<VAR_SERIALISE_STRING_ESCAPE_FROM_LIST.length;i++){value=value.replace(VAR_SERIALISE_STRING_ESCAPE_FROM_LIST_REG_EXP[i],VAR_SERIALISE_STRING_ESCAPE_TO_LIST[i]);}
case"integer":case"double":str+='<val_type>'+type+'</val_type><val>'+value+'</val>\n';break;case"null":str+='<val_type>'+type+'</val_type><val></val>\n';break;case"boolean":str+='<val_type>'+type+'</val_type><val>'+((value)?1:0)+'</val>\n';break;case"array":str+='<val_type>'+type+'</val_type>\n';for(var k in value){if(value.hasOwnProperty(k)){var sub_str=_var_serialise(value[k],indent+' ');if(sub_str==false)return false;if(VAR_SERIALISE_STRING_ESCAPE_CHAR_REG_EXP.test(k)){alert(js_translate('data_contains_escape_character',VAR_SERIALISE_STRING_ESCAPE_CHAR.charCodeAt(0)));k=k.replace(VAR_SERIALISE_STRING_ESCAPE_CHAR_REG_EXP,'');}
for(var i=0;i<VAR_SERIALISE_STRING_ESCAPE_FROM_LIST.length;i++){k=k.replace(VAR_SERIALISE_STRING_ESCAPE_FROM_LIST_REG_EXP[i],VAR_SERIALISE_STRING_ESCAPE_TO_LIST[i]);}
str+=indent+' <name_type>'+gettype(k).toLowerCase()+'</name_type><name>'+k+'</name>'+sub_str;}}
break;default:alert(js_translate('unable_to_serialise',type));return false;}
return str;}
function gettype(value)
{if(value==null)return'NULL';var type=typeof(value);switch(type){case"number":var str_value=value.toString();if(str_value.indexOf(".")>=0){type="double";}else{type="integer";}
break;case"object":type="array";break;}
return type;}
var VAR_UNSERIALISE_I=0;function var_unserialise(str)
{var lines_str=str.replace(/\r\n/g,'\n');lines_str=lines_str.replace(/\r/g,'\n');if(lines_str.charAt(lines_str.length-1)=="\n"){lines_str=lines_str.substr(0,lines_str.length-1);}
var lines=lines_str.split("\n");VAR_UNSERIALISE_I=0;var results=_var_unserialise(lines,'');return results[0];}
function _var_unserialise(lines,indent)
{var str=lines[VAR_UNSERIALISE_I];if(str=="")return Array(null,null);var name_type="";var name=null;var re=new RegExp('^'+indent+'<name_type>(.*)<\/name_type><name>(.*)<\/name>(.*)$');var matches=re.exec(str);if(matches!=null){name_type=matches[1];name=settype(matches[2],name_type);str=matches[3];}
if(str=='<val_type>array</val_type>'){var indent_len=indent.length;VAR_UNSERIALISE_I++;var val=new Array();while(lines[VAR_UNSERIALISE_I]!=null&&indent+' '==lines[VAR_UNSERIALISE_I].substr(0,indent_len+1)){var results=_var_unserialise(lines,indent+' ');val[results[1]]=results[0];VAR_UNSERIALISE_I++;}
VAR_UNSERIALISE_I--;return new Array(val,name);}
val_type="";val=null;re=new RegExp('^<val_type>(.*)<\/val_type><val>(.*)<\/val>$');matches=re.exec(str);if(matches!=null){val_type=matches[1];val=settype(matches[2],val_type);}
return new Array(val,name);}
function settype(value,type){var val=null;switch(type){case"integer":val=parseInt(value);break;case"double":val=parseFloat(value);break;case"boolean":val=(value)?true:false;break;case"string":val=value.toString();for(var i=0;i<VAR_SERIALISE_STRING_ESCAPE_FROM_LIST.length;i++){val=val.replace(VAR_SERIALISE_STRING_ESCAPE_TO_LIST_REG_EXP[i],VAR_SERIALISE_STRING_ESCAPE_FROM_LIST[i]);}
break;case"null":val=null;break;default:val=value;}
return val;}
function htmlspecialchars(str){s=new String(str);s=s.replace(/\&/g,'&amp;');s=s.replace(/\"/g,'&quot;');s=s.replace(/</g,'&lt;');s=s.replace(/>/g,'&gt;');return s;}
function rev_htmlspecialchars(str){s=new String(str);s=s.replace(/\&amp;/g,'&');s=s.replace(/\&quot;/g,'"');s=s.replace(/\&lt;/g,'<');s=s.replace(/&gt;/g,'>');return s;}
String.prototype.trim=function(){var str=this.toString();str=str.replace(/^\s+/,'');str=str.replace(/\s+$/,'');return str;}
function array_unique(arr){var new_arr=new Array();arr.sort();var tmp='';for(var i=0;i<arr.length;i++){if(arr[i]!=tmp){new_arr.push(arr[i]);tmp=arr[i];}}
return new_arr;}
function array_remove_element(arr,val,remove_all){if(remove_all==null){remove_all=false;}
var i=null;do{var i=array_search(arr,val);if(i!=null)arr.splice(i,1);}while(remove_all&&i!=null);}
function array_search(arr,val){for(var i=0;i<arr.length;i++){if(arr[i]==val)return i;}
return null;}
function array_copy(arr){var new_arr=new Array();for(var i=0;i<arr.length;i++){new_arr[i]=arr[i];}
return new_arr;}
var preloaded_images=new Array();function preload_image(src){var i=preloaded_images.length;preloaded_images[i]=new Image();preloaded_images[i].src=src;}
function img_roll(id,src){if(document.images){document[id].src=src;}}
function check_all(f,match_name,on){re=new RegExp(match_name);for(i=0;i<f.elements.length;i++){if(re.test(f.elements[i].name)){f.elements[i].checked=on;}}}
function check_all_by_parent(e,match_name,on){re=new RegExp(match_name);var items=e.getElementsByTagName('input');for(i=0;i<items.length;i++){if(items[i].type=='checkbox'&&re.test(items[i].name)){items[i].checked=on;}}}
function update_checked(f,match_name,check_all_id){var all_checked=true;re=new RegExp(match_name);for(i=0;i<f.elements.length;i++){if(re.test(f.elements[i].name)){if(f.elements[i].checked==false){all_checked=false;}}}
document.getElementById(check_all_id).checked=all_checked;}
function number_format(num,places,dec_point,thousands_sep){num=parseFloat(num);if(isNaN(num))num=0;places=parseInt(places);if(isNaN(places)||places<0)places=0;if(dec_point==undefined||dec_point==null)dec_point='.';if(thousands_sep==undefined||thousands_sep==null)thousands_sep='';if(places==0){return _number_format_thousand_separators(Math.round(num),thousands_sep);}else{if(num==0){var str='0'+dec_point;for(var i=0;i<places;i++){str+='0';}
return str;}else{var big_num=Math.round(num*Math.pow(10,places));str=big_num.toString();var dec_place=(str.length-places);var dec_str=_number_format_thousand_separators(str.substr(0,dec_place),thousands_sep);var places_str=str.substr(dec_place);return dec_str+dec_point+places_str;}}}
function _number_format_thousand_separators(str,sep){str=str.toString();if(sep=='')return str;if(str.length<=3)return str;var new_str='';var i=str.length%3;var prefix_comma=false;if(i>0){new_str+=str.substr(0,i);prefix_comma=true;}
while(i<str.length){if(prefix_comma)new_str+=sep;new_str+=str.substr(i,3);i+=3;prefix_comma=true;}
return new_str;}
function sq_print_icon(path,width,height,alt){document.write('<img src="'+path+'" width="'+width+'" height="'+height+'" border="0" alt="'+alt+'" />');}
function fixIcons(blankSrc)
{var ieVersion=0;if(navigator.appVersion.indexOf("MSIE")!=-1){temp=navigator.appVersion.split("MSIE");ieVersion=parseFloat(temp[1]);}
if((ieVersion>=5.5)&&(ieVersion<7)){var images=document.getElementsByTagName('IMG');for(var i=0;i<images.length;i++){if(images[i].className.match(/(^| )sq-icon($| )/)){images[i].style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+images[i].src+"', sizingMethod='scale')";images[i].style.height=images[i].height+'px';images[i].style.width=images[i].width+'px';images[i].src=blankSrc;}}}}
function sq_redirect(url){document.write("<html>");document.write(" <head>");document.write("  <style type=\"text/css\">");document.write("   body {");document.write("    font-size:   12px;");document.write("    font-family:  Arial, Verdana, Helvetica, sans-serif;");document.write("    color:    #000000;");document.write("    background-color: #FFFFFF;");document.write("   }");document.write("  </style>");document.write(" </head>");document.write(" <body>");document.write("  Please wait while you are redirected. If you are not redirected, please click <a href=\""+url+"\" title=\"Click here to manually redirect\">here</a>");document.write(" </body>");document.write("</html>");window.location=url;}
function sprintf(){var txt=arguments[0];var c=1;var pattern=/%\d*\$*s/;while(c<arguments.length){replace=new RegExp(((txt.match(pattern)).toString()).replace(/\$/,'\\\$'),"g");txt=txt.replace(replace,arguments[(replace.toString()).match(/\d/)]);c++;}
return(txt);}
function vsprintf(){var txt=arguments[0];var pattern=/%\d+\$s/;while(txt.match(pattern)){replace=new RegExp(((txt.match(pattern)).toString()).replace(/\$/,'\\\$'),"g");arg_index=(replace.toString()).match(/\d/)-1;txt=txt.replace(replace,arguments[1][arg_index]);}
var pattern=/%s/;var current_s=0;while(txt.match(pattern)){txt=txt.replace(pattern,arguments[1][current_s]);current_s++;}
return(txt);}
function sq_handle_toggle(the_toggler){toggleElements=the_toggler.parentNode.getElementsByTagName('a');for(var i in toggleElements){if(toggleElements[i].className=='selected'){toggleElements[i].className='';}}
the_toggler.className='selected';return false;}
function ajax_request(url,callback,method,data,async)
{if(url==null){return;}
if(method==null){method='GET';}
if(async==null){async=true;}
var xhr=new XMLHttpRequest();xhr.open(method,url,async);if(method=='POST'&&data){xhr.setRequestHeader('Content-type','application/x-www-form-urlencoded');}
if(async&&typeof(callback)=='function'){xhr.onreadystatechange=function(){if(xhr.readyState===4){var response=xhr.responseText;callback(response);}}}
xhr.send(data);if(!async&&callback!=null&&typeof(callback)=='function'){var response=xhr.responseText;callback(response);}}
if(typeof htmlspecialchars=='undefined'){alert('You need to include general.js as well');}
if(!alert_win){var alert_win=null;}
function print_alert(str){if(!alert_win||(alert_win&&alert_win.closed)){alert_win=window.open('','alert_window');alert_win.document.open();alert_win.document.writeln("<html><body><pre>");}
alert_win.document.writeln(htmlspecialchars(str));alert_win.document.writeln("\n----------------------------------------");}
function get_caller(func){if(func.caller==null)return"Top";var e='function ([^{]+)\\{.*';var re=new RegExp(e,"i");var results=re.exec(func.caller.toString());if(results!=null){var func_name=results[1];return func_name;}else{return func.caller;}}
function is_object(arr)
{return(typeof(arr)=='object');}
function is_array(arr)
{return(typeof(arr)=='object'&&arr.length!=null);}
function array_contents(arr,max_depth,depth,indent)
{if(max_depth==null)max_depth=5;if(depth==null)depth=0;if(indent==null)indent="";if(arr==null)
{return"[ NULL VALUE OBJECT ]";}
if(is_object(arr))
{indent+="       ";var str="";if(is_array(arr))str+="array ";else str+="object";str+=" (\n";depth++;for(var key in arr)
{var val=arr[key];var key_str="";if(typeof(key)=="string")key_str="\""+key+"\"";else key_str=key;key_str+=" => ";var val_str="";if(is_object(val)&&max_depth>depth)
{var new_indent=indent.toString();for(i=0;i<key_str.length;i++)
{new_indent+=" ";}
val_str=array_contents(val,max_depth,depth,new_indent);}
else
{if(typeof(arr[key])=="function")val_str="[ FUNCTION ]";else if(typeof(val)=="string")val_str="\""+val+"\"";else if(val==null)val_str="[ NULL ]";else val_str=val;}
str+=indent+key_str+val_str+",\n";}
str+="\n"+indent+")";return str;}
else
{return arr.toString();}}
function print_array_contents(arr,max_depth,depth)
{if(max_depth==null)max_depth=5;if(depth==null)depth=0;var new_win=window.open('','array_contents');new_win.document.open();new_win.document.writeln("<html><body><pre>");_print_array_contents(new_win.document,arr,max_depth,depth);new_win.document.writeln("</pre></body></html>");new_win.document.close();}
function _print_array_contents(win_doc,arr,max_depth,depth,indent)
{if(indent==null)indent="";if(arr==null)
{win_doc.write("[ NULL VALUE OBJECT ]");return;}
if(is_object(arr))
{indent+="        ";if(is_array(arr))win_doc.write("array ");else win_doc.write("object");win_doc.writeln(" (");depth++;for(var key in arr)
{var val=arr[key];var key_str="";if(typeof(key)=="string")key_str="\""+key+"\"";else key_str=key;key_str+=" => ";win_doc.write(indent+key_str);if(is_object(val)&&max_depth>depth&&val!=undefined)
{var new_indent=indent.toString();for(i=0;i<key_str.length;i++)
{new_indent+=" ";}
_print_array_contents(win_doc,val,max_depth,depth,new_indent);}
else
{if(typeof(arr[key])=="function")win_doc.write("[ FUNCTION ]");else if(typeof(val)=="string")win_doc.write("\""+htmlspecialchars(val)+"\"");else if(val==null)win_doc.write("[ NULL ]");else win_doc.write(val);}
win_doc.writeln(",");}
win_doc.write(indent+")");}
else
{win_doc.write(arr.toString());}}
function pre_echo(str){document.writeln('<div align="left"><pre style="font-family: courier, monospace;">');document.writeln(htmlspecialchars(str));document.writeln("\n----------------------------------------");document.writeln('</pre></div>');}
var initialisedEditors=new Array();function switchEditingMode(contentDivID,editDivID,editor){var contentDiv=document.getElementById(contentDivID);var editDiv=document.getElementById(editDivID);if(editDiv.style.display=="none"){var setDesignMode=true;if(initialisedEditors[editor._uniqueID]==null){initialisedEditors[editor._uniqueID]=true;editor.generate();setDesignMode=false;}else if(editor._initialised!=true){return;}
editDiv.style.display="";if(editor._iframe){editor._iframe.style.width=editor.config.width;if(setDesignMode&&HTMLArea.is_gecko){editor._iframe.contentWindow.document.designMode="on";}
editor._iframe.style.height=editor.config.height;}
contentDiv.style.display="none";}else if(editor._initialised==true){contentDiv.innerHTML=editor.getHTML();contentDiv.style.display="";editDiv.style.display="none";if(editor._iframe){var editCell=document.getElementById(editor._uniqueID+"_cell");if(editCell){editCell.style.height="100%";}}}}
function sq_toggle_lock_info(){var lockInfo=document.getElementById('sq_lock_info');var lockToggle=document.getElementById('sq_lock_info_toggle');if(lockInfo.style.display=='none'){lockInfo.style.display='block';lockToggle.innerHTML=js_translate('hide_lock_details');}else{lockInfo.style.display='none';lockToggle.innerHTML=js_translate('show_lock_details');}}
function sq_toggle_asset_info(clicked){var assetInfo=document.getElementById('sq_asset_info');if(assetInfo.style.display=='none'){assetInfo.style.display='block';clicked.innerHTML='[ '+js_translate('less_info')+' ]';}else{assetInfo.style.display='none';clicked.innerHTML='[ '+js_translate('more_info')+' ]';}}
function sq_toggle_double_div(div1ID,div2ID,textID,text1,text2){var div1=document.getElementById(div1ID);var div2=document.getElementById(div2ID);var infoToggle=document.getElementById(textID);if(div1.style.display=='none'){div1.style.display='block';div2.style.display='none';infoToggle.innerHTML=text1;}else{div1.style.display='none';div2.style.display='block';infoToggle.innerHTML=text2;}}
function checkDurationValue(input,evt)
{var prevalue=input.value;var key=(typeof evt.which=="undefined")?evt.keyCode:evt.which;if(key==8||key==0)return true;textboxReplaceSelect(input,String.fromCharCode(key));var newval=input.value;if(key==45){newval=prevalue-1;}
if(key==43){newval=prevalue*1+1;}
if(newval<0)newval=0;if(newval*1==newval){input.value=Math.floor(newval);}else{input.value=prevalue;}
if(key==43||key==45){updateDurationValues(input);}
evt.cancelBubble=true;evt.returnValue=false;return false;}
function updateDurationValues(input)
{var fields=Array("days","hours","minutes","seconds");var weights=Array(86400,3600,60,1);var prefix="";for(var i=0;i<fields.length;i++){if(input.id.indexOf(fields[i])>0){prefix=input.id.substring(0,input.id.indexOf(fields[i]));}}
var total=0;for(var i=0;i<fields.length;i++){var element=document.getElementById(prefix+fields[i]);if(element){total+=element.value*weights[i];}}
for(var i=0;i<fields.length;i++){var element=document.getElementById(prefix+fields[i]);if(element){curvalue=Math.floor(total/weights[i]);total-=curvalue*weights[i];element.value=curvalue;}}}
function textboxReplaceSelect(input,text)
{if(document.selection){var range=document.selection.createRange();range.text=text;range.collapse(true);range.select();}else{var start=input.selectionStart;input.value=input.value.substring(0,start)+text+input.value.substring(input.selectionEnd,input.value.length);input.setSelectionRange(start+text.length,start+text.length);}
input.focus();}
var expandListFn=new Function('expandOptionList(this, true)');var noreorderExpandListFn=new Function('expandOptionList(this, false)');var deleteRowFn=new Function('deleteOptionListRow(this, true); return false;');var noreorderDeleteRowFn=new Function('deleteOptionListRow(this, false); return false;');function expandOptionList(input,reorder)
{var nextInput=input.nextSibling;while(nextInput!==null){if(nextInput.tagName=='INPUT'){return;}
nextInput=nextInput.nextSibling;}
var lastInput=input.previousSibling;if(input.value==''){while(lastInput!==null){if(lastInput.tagName=='INPUT'){if(lastInput.value==''){return;}
break;}
lastInput=lastInput.previousSibling;}}
var inputs=optionList.getElementsByTagName('INPUT');if(reorder){var moveDownButton=lastInput.nextSibling;while(moveDownButton!=null){moveDownButton=moveDownButton.nextSibling;if(moveDownButton.tagName=='A'&&moveDownButton.name=="movedown"){break;}}
moveDownButton=moveDownButton.cloneNode(true);moveDownButton.id=optionItemPrefix+'_options['+(inputs.length-1)+']';var buttonScript=moveDownButton.getElementsByTagName("script")[0];var browserAgent=navigator.userAgent.toLowerCase();if((browserAgent.indexOf("safari")!=-1)&&buttonScript!=null){moveDownButton.removeChild(buttonScript);}
var brElements=lastInput.parentNode.getElementsByTagName('BR');lastInput.parentNode.removeChild(brElements[brElements.length-1]);input.parentNode.appendChild(moveDownButton);input.parentNode.appendChild(document.createElement('BR'));}
var newInput=input.cloneNode(true);if(reorder){newInput.onfocus=expandListFn;}else{newInput.onfocus=noreorderExpandListFn;}
newInput.value='';newInput.id=optionItemPrefix+'_options['+inputs.length+']';input.parentNode.appendChild(newInput);var delButton=input.nextSibling;while(delButton.tagName!='BUTTON'){delButton=delButton.nextSibling;}
delButton=delButton.cloneNode(true);if(reorder){delButton.onclick=deleteRowFn;}else{delButton.onclick=noreorderDeleteRowFn;}
input.parentNode.appendChild(delButton);if(reorder){var moveUpButton=input.nextSibling;while(moveUpButton!=null){if(moveUpButton.tagName=='A'&&moveUpButton.name=='moveup'){break;}
moveUpButton=moveUpButton.nextSibling;}
moveUpButton=moveUpButton.cloneNode(true);moveUpButton.id=optionItemPrefix+'_options['+(inputs.length-1)+']';var buttonScript=moveUpButton.getElementsByTagName("script")[0];var browserAgent=navigator.userAgent.toLowerCase();if((browserAgent.indexOf("safari")!=-1)&&buttonScript!=null){moveUpButton.removeChild(buttonScript);}
input.parentNode.appendChild(moveUpButton);}
input.parentNode.appendChild(document.createElement('BR'));}
function listMoveUp(obj,optionList){var currentOrder=0;var inputs=optionList.getElementsByTagName('INPUT');for(var i=0;i<inputs.length;i++){if(obj.id==inputs[i].id){currentOrder=i;break;}}
if(currentOrder==0)return;if(inputs[currentOrder].disabled)return;var temp=inputs[currentOrder-1].value;inputs[currentOrder-1].value=inputs[currentOrder].value;inputs[currentOrder].value=temp;}
function listMoveDown(obj,optionList){var currentOrder=0;var inputs=optionList.getElementsByTagName('INPUT');for(var i=0;i<inputs.length;i++){if(obj.id==inputs[i].id){currentOrder=i;break;}}
if(currentOrder==inputs.length)return;if(inputs[currentOrder].disabled)return;var temp=inputs[currentOrder+1].value;inputs[currentOrder+1].value=inputs[currentOrder].value;inputs[currentOrder].value=temp;}
function deleteOptionListRow(button,reorder)
{var input=button.previousSibling;while(input.tagName!='INPUT'){input=input.previousSibling;}
if(input.value=='')return;if(input.disabled)return;var inputs=input.parentNode.getElementsByTagName('INPUT');if(inputs.length<=2){input.value='';return;}
if(reorder){var moveUpBut=button.nextSibling;while(moveUpBut!=null){if(moveUpBut.tagName=='A'&&moveUpBut.name=='moveup'){break;}
moveUpBut=moveUpBut.nextSibling;}
var moveDownBut=button.nextSibling;while(moveDownBut!=null){if(moveDownBut.tagName=='A'&&moveDownBut.name=='movedown'){break;}
moveDownBut=moveDownBut.nextSibling;}
if(moveUpBut==null||moveDownBut==null)return;button.parentNode.removeChild(moveUpBut);button.parentNode.removeChild(moveDownBut);}
var brTag=button.nextSibling;while(brTag.tagName!='BR'){brTag=brTag.nextSibling;}
button.parentNode.removeChild(input);button.parentNode.removeChild(brTag);button.parentNode.removeChild(button);}
var expandDateListFn=new Function('expandDateList(this)');var deleteDateRowFn=new Function('deleteDateListRow(this); return false;');function allVisibleInputsEmpty(elt)
{var inputs=elt.getElementsByTagName('INPUT');for(var i=0;i<inputs.length;i++){if(inputs[i].type=='hidden')continue;if(inputs[i].value!=''){return false;}}
var selects=elt.getElementsByTagName('SELECT');for(var i=0;i<selects.length;i++){if((selects[i].value!='')&&(selects[i].value!='--')){return false;}}
return true;}
function clearAllVisibleInputs(elt)
{var inputs=elt.getElementsByTagName('INPUT');for(var i=0;i<inputs.length;i++){if(inputs[i].type=='hidden')continue;inputs[i].value='';}
var selects=elt.getElementsByTagName('SELECT');for(var i=0;i<selects.length;i++){selects[i].selectedIndex=0;}}
function expandDateList(input)
{var currentSpan=input.parentNode;while(currentSpan.tagName!='SPAN')currentSpan=currentSpan.parentNode;var nextSpan=currentSpan.nextSibling;while(nextSpan!==null){if(nextSpan.tagName=='SPAN'){return;}
nextSpan=nextSpan.nextSibling;}
lastSpan=currentSpan.previousSibling;while(lastSpan.tagName!='SPAN')lastSpan=lastSpan.previousSibling;if(allVisibleInputsEmpty(lastSpan)&&allVisibleInputsEmpty(currentSpan)){return;}
var newSpan=currentSpan.cloneNode(true);attachDateListEventHandlers(newSpan);clearAllVisibleInputs(newSpan);var delButton=currentSpan.nextSibling;while(delButton.tagName!='BUTTON'){delButton=delButton.nextSibling;}
delButton=delButton.cloneNode(true);delButton.onclick=deleteDateRowFn;input.parentNode.parentNode.appendChild(newSpan);input.parentNode.parentNode.appendChild(delButton);input.parentNode.parentNode.appendChild(document.createElement('BR'));}
function deleteDateListRow(button)
{var span=button.previousSibling;while(span.tagName!='SPAN'){span=span.previousSibling;}
if(span.getElementsByTagName('INPUT')[0].value=='')return;var brTag=button.nextSibling;while(brTag.tagName!='BR'){brTag=brTag.nextSibling;}
button.parentNode.removeChild(span);button.parentNode.removeChild(brTag);button.parentNode.removeChild(button);}
function attachDateListEventHandlers(parent)
{var inputs=parent.getElementsByTagName('INPUT');for(var j=0;j<inputs.length;j++){inputs[j].onfocus=expandDateListFn;}
var selects=parent.getElementsByTagName('SELECT');for(var j=0;j<selects.length;j++){selects[j].onchange=expandDateListFn;}
var buttons=parent.getElementsByTagName('BUTTON');for(var j=0;j<buttons.length;j++){buttons[j].onclick=deleteDateRowFn;}}
function focusFirstTextInput()
{var inputs=document.getElementsByTagName('INPUT');for(var i=0;i<inputs.length;i++){if((inputs[i].type=='text')&&(!inputs[i].disabled)){try{inputs[i].focus();return;}catch(e){}}}}
function pagePrint()
{window.setTimeout('window.print()',100);}
function showPrintPopup()
{var args='width='+(self.screen.availWidth/2)+',height='+parseInt(self.screen.availHeight*0.8)+',status=0,location=0,menubar=0,directories=0,scrollbars=1,resizable=1';var urlSuffix='&ignore_frames=1&print_view=1';var urlBase=self.location.href;if(urlBase.indexOf('&assetid=')==-1){var mainForm=document.getElementById('main_form');if(mainForm)urlBase=mainForm.action;}
var printWindow=window.open(urlBase+urlSuffix,'printWindow',args);}
function initEnableFieldLists()
{var uls=document.getElementsByTagName('UL');for(var i=0;i<uls.length;i++){if(uls[i].className.match(/(^| )enable-field-list($| )/)){var lis=uls[i].getElementsByTagName('INPUT');for(var j=0;j<lis.length;j++){if(lis[j].type=='radio'){lis[j].onclick=updateEnableFieldList;if(lis[j].checked)lis[j].click();}}}}}
function setInputsEnabled(parent,enabled)
{var inputs=parent.getElementsByTagName('INPUT');for(var i=0;i<inputs.length;i++){inputs[i].disabled=!enabled;}
var selects=parent.getElementsByTagName('SELECT');for(var i=0;i<selects.length;i++){selects[i].disabled=!enabled;}}
function updateEnableFieldList()
{var parentLI=this.parentNode;while(parentLI.tagName!='LI'){parentLI=parentLI.parentNode;}
var parentUL=parentLI.parentNode;while(parentUL.tagName!='UL'){parentUL=parentUL.parentNode;}
var lis=parentUL.getElementsByTagName('LI');for(var j=0;j<lis.length;j++){var div=lis[j].getElementsByTagName('DIV')[0];div.className=(lis[j]==parentLI)?'active':'';setInputsEnabled(div,lis[j]==parentLI);}}
function toggleNextElt(elt,targetType)
{var target=elt.nextSibling;var i=0;while(target.tagName!=targetType){if(i++>20)return;if(target.nextSibling){target=target.nextSibling;}else{target=target.parentNode.nextSibling;if(target.firstChild){target=target.firstChild;}}}
with(target.style){display=(display=='none')?'block':'none';}}
function sq_pager_jump(page_field,val)
{if(isNaN(val)==false){set_hidden_field(page_field,val);set_hidden_field('process_form','0');submit_form();}
return false;}
function sq_pager_prompt(min,max)
{var pageNo=prompt(js_translate('sq_pager_prompt_js',min,max));pageNo=parseInt(pageNo,10);if(isNaN(pageNo)==false){if((pageNo>=min)&&(pageNo<=max)){return pageNo;}}
return NaN;}
function ToolTip()
{this.normal_font="100% Tahoma,Arial";this.title_font="bold 120% Tahoma,Arial";this.title_align="left";this.normal_color="#000000";this.title_color="#FFFFFF";this.showing=false;this.print=tt_print;this.show=tt_show;this.hide=tt_hide;this.paint=tt_paint;this.getLeft=tt_getLeft;this.set=tt_set;this.get=tt_get;}
function tt_print()
{if(!document.getElementById("ToolBox"))
{output='<div id="ToolBox" class="sq-toolbox-wrapper" style="position: absolute; z-index: 1001;"><table class="sq-toolbox-table"><tr><td id="ToolBoxTitle" class="sq-toolbox-title"></td></tr><tr><td class="sq-toolbox-content" id="ToolBoxContent"></td></tr></table></div>';if(document.body.insertAdjacentHTML){document.body.insertAdjacentHTML('afterBegin',output);}
else if(document.documentElement){var div=document.createElement('div');div.innerHTML=output;document.body.insertBefore(div,document.body.firstChild);}
else{document.body.innerHTML=output+document.body.innerHTML;}}}
function findPosX(obj)
{var curleft=0;if(obj.offsetParent)
{while(obj.offsetParent)
{curleft+=obj.offsetLeft
obj=obj.offsetParent;}}
else if(obj.x)
curleft+=obj.x;return curleft;}
function findPosY(obj)
{var curtop=0;if(obj.offsetParent)
{while(obj.offsetParent)
{curtop+=obj.offsetTop
obj=obj.offsetParent;}}
else if(obj.y)
curtop+=obj.y;return curtop;}
function tt_show(obj,text,title,close_button)
{if(obj==null)return;this.print();var top=findPosY(obj);top+=obj.offsetHeight;var left=this.getLeft(obj);this.paint(top,left,text,title,close_button);this.showing=true;}
function tt_hide()
{var tool_box=document.getElementById("ToolBox");if(tool_box.filters&&tool_box.filters[0])tool_box.filters[0].Apply();tool_box.style.visibility="hidden";if(tool_box.filters&&tool_box.filters[0])tool_box.filters[0].Play();this.showing=false;}
function tt_paint(top,left,text,title,close_button)
{var tool_box=document.getElementById("ToolBox");if(tool_box.filters&&tool_box.filters[0])tool_box.filters[0].Apply();if((typeof(title)!="undefined"&&title!="")||(typeof(top)=="undefined"))
{if(typeof(title)!="undefined")document.getElementById("ToolBoxTitle").innerHTML=unescape(title);if(closeElement=document.getElementById("ToolBoxClose")){closeElement.parentNode.removeChild(closeElement);}
if(typeof close_button!='undefined'){closeElement=document.createElement('th');closeElement.style.textAlign='right';closeElement.style.padding='2px';closeElement.id='ToolBoxClose';if(close_button==true){close_button='X';}
closeElement.innerHTML='<a href="#" style="text-decoration: none; color: '+this.title_color+'" onclick="tooltip.hide(); return false;">'+close_button+'</a>';document.getElementById("ToolBoxTitle").parentNode.appendChild(closeElement);document.getElementById("ToolBoxContent").colSpan=2;}}
else
{document.getElementById("ToolBoxTitle").innerHTML="";}
if((typeof(text)!="undefined"&&text!="")||(typeof(top)=="undefined"))
{if(typeof(text)!="undefined")
{var unescapedText=unescape(text);if(unescapedText.indexOf('<table')>-1||unescapedText.indexOf('<p')>-1){}else{unescapedText='<div class="sq-toolbox-content-wrapper">'+unescapedText+'</div>';}
document.getElementById("ToolBoxContent").innerHTML=unescapedText;}}
else
{document.getElementById("ToolBoxContent").innerHTML="";}
if((typeof(top)!="undefined")&&(typeof(left)!="undefined"))
{var win_width=((window.innerWidth)?window.innerWidth:document.body.offsetWidth)-20;if((tool_box.offsetWidth+left)>win_width)left-=(tool_box.offsetWidth+left)-win_width;tool_box.style.top=top+"px";tool_box.style.left=left+"px";}
tool_box.style.visibility="visible";if(tool_box.filters&&tool_box.filters[0])tool_box.filters[0].Play();}
function tt_get(attr)
{if(typeof(eval("this."+attr))=="undefined")return false;return eval("this."+attr);}
function tt_set(attr,value)
{if(typeof(eval("this."+attr))=="undefined")return false;eval("this."+attr+" = '"+value+"'");if(document.getElementById("ToolBox").style.visibility=="visible")this.paint();}
function tt_getLeft(elem)
{var offsetLeft=0;do{if(!isNaN(elem.offsetLeft)){offsetLeft+=elem.offsetLeft;}}while(elem=elem.offsetParent);return offsetLeft;}
var tooltip=new ToolTip();
var SQ_CURRENT_LOCALE=null;var translated_strings=new Array();function get_locale_parts(locale)
{var locale_parts=new Array();var lang_pos=locale.indexOf('_');if(lang_pos==-1){locale_parts[0]=locale;return locale_parts;}
locale_parts[0]=locale.substring(0,lang_pos-1);locale=locale.substring(lang_pos+1,locale.length);var variant_pos=locale.indexOf('@');if(variant_pos==-1){locale_parts[1]=locale;}else{locale_parts[1]=locale.substring(0,variant_pos-1);locale_parts[2]=locale.substring(variant_pos+1,locale.length);}
return locale_parts;}
function get_cumulative_locale_parts(locale)
{var locale_parts=get_locale_parts(locale);var cum_locale_parts=Array();cum_locale_parts.push(locale_parts[0]);if(locale_parts.length>=2){cum_locale_parts.push(cum_locale_parts[0]+'_'+locale_parts[1]);if(locale_parts.length>=3){cum_locale_parts.push(cum_locale_parts[1]+'@'+locale_parts[2]);}}
return cum_locale_parts;}
function js_translate()
{var locale_parts=get_cumulative_locale_parts(SQ_CURRENT_LOCALE);var found_string=null;var replacements=[];for(i=1;i<arguments.length;i++){replacements.push(arguments[i]);}
while(locale_parts.length>0){locale=locale_parts.pop();if(!translated_strings[locale][arguments[0]])continue;return vsprintf(translated_strings[locale][arguments[0]],replacements);}
return'string code '+arguments[0]+' not found';}
function Layer_Handler(div_id,top,right,bottom,left){if(is_major<4){alert(js_translate('unable_to_use_layers'));return;}
if(is_dom){this.layer=document.getElementById(div_id);if(this.layer==null){this.layer_OK=false;return this;}
this.layer_OK=true;this.style=this.layer.style;this.x=this.style.left;this.y=this.style.top;this.w=this.style.width;this.h=this.style.height;}else if(is_nav4up){if(typeof document.layers[div_id]=='undefined'){this.layer_OK=false;return this;}
this.layer_OK=true;this.layer=document.layers[div_id];this.style=document.layers[div_id];this.x=this.layer.left;this.y=this.layer.top;this.w=this.layer.clip.width;this.h=this.layer.clip.height;}else if(is_ie4up){if(typeof document.all[div_id]=='undefined'){this.layer_OK=false;return this;}
this.layer_OK=true;this.layer=document.all[div_id];this.style=document.all[div_id].style;this.x=this.layer.offsetLeft;this.y=this.layer.offsetTop;this.w=(is_ie4)?this.style.pixelWidth:this.layer.offsetWidth;this.h=(is_ie4)?this.style.pixelHeight:this.layer.offsetHeight;}
this.move=move;this.show=show;this.hide=hide;this.clip=clip;this.write=write;this.clip(top,right,bottom,left);return this;function move(x,y){if(x!=null){this.x=x;if(is_dom)this.style.left=this.x+"px";else if(is_nav)this.style.left=this.x;else this.style.pixelLeft=this.x;}
if(y!=null){this.y=y;if(is_dom)this.style.top=this.y+"px";else if(is_nav)this.style.top=this.y;else this.style.pixelTop=this.y;}}
function show(){this.style.visibility=(is_nav4)?"show":"visible";this.style.zIndex=1001;}
function hide(){this.style.visibility=(is_nav4)?"hide":"hidden";this.style.zIndex=-1;}
function clip(top,right,bottom,left){var clip_values=new Object();if(is_dom||is_ie){var re=/rect\(([0-9]*)px ([0-9]*)px ([0-9]*)px ([0-9]*)px\)/i;var result=re.exec(this.style.clip);clip_values["top"]=(result)?result[1]:0;clip_values["right"]=(result)?result[2]:0;clip_values["bottom"]=(result)?result[3]:0;clip_values["left"]=(result)?result[4]:0;}else{clip_values["top"]=this.style.clip.top;clip_values["right"]=this.style.clip.right;clip_values["bottom"]=this.style.clip.bottom;clip_values["left"]=this.style.clip.left;}
if(top!=null)clip_values["top"]=top;if(right!=null)clip_values["right"]=right;if(bottom!=null)clip_values["bottom"]=bottom;if(left!=null)clip_values["left"]=left;if(is_dom||is_ie){this.style.clip="rect("
+clip_values["top"]+"px "
+clip_values["right"]+"px "
+clip_values["bottom"]+"px "
+clip_values["left"]+"px)";}else if(is_nav4up){this.style.clip.top=clip_values["top"];this.style.clip.right=clip_values["right"];this.style.clip.bottom=clip_values["bottom"];this.style.clip.left=clip_values["left"];}}
function write(html){if(is_dom||is_ie){this.layer.innerHTML=html;}else{this.layer.document.open();this.layer.document.write(html);this.layer.document.close();}}}
function submit_form(f)
{if(f==null){f=document.main_form;}
SQ_FORM_ERROR_CONTAINED=false;inputs=f.getElementsByTagName('input');for(var i=0;i<inputs.length;i++){if(inputs[i].name=='submit'){SQ_FORM_ERROR_CONTAINED=true;}}
if(!f.onsubmit||f.onsubmit()){f.submit();}}
function set_hidden_field(name,value,f)
{if(f==null){f=document.main_form;}
if(f.elements[name]){f.elements[name].value=value;}}
function set_text_field(name,value,f)
{if(f==null){f=document.main_form;}
if(f.elements[name]){f.elements[name].value=value;}}
set_button_value=set_hidden_field;function validate_numeric_text_field(name,allow_negative)
{if(arguments.length<2)return false;if(parseInt(name.value)!=name.value||(name.value.length>0&&allow_negative==false&&name.value.charAt(0)=="-")){var outstr="";for(var ii=0;ii<name.value.length;ii++){if((parseInt(name.value.charAt(ii))==name.value.charAt(ii))||(allow_negative==true&&ii==0&&name.value.charAt(ii)=="-")){outstr+=name.value.charAt(ii);}}
name.value=outstr;if(name.createTextRange){var range=name.createTextRange();range.moveStart("character",name.value.length);range.moveEnd("character",0);range.select();}else if(name.selectionStart||name.selectionStart==0){name.selectionEnd=name.selectionStart=name.value.length;}}
if(arguments.length>3){validate_numeric_range(name,arguments[2],arguments[3],false);}}
function validate_numeric_range(name,min,max,allow_empty)
{if(arguments.length<3)return false;if(arguments.length==3)allow_empty=false;if(allow_empty&&(name.value=='')){return;}
if(name.value<min){if((arguments.length==3)||(arguments.length>=4&&arguments[3])){name.value=min;}}
if(name.value>max){name.value=max;}}
function get_form_element(name,f)
{if(f==null){f=document.main_form;}
if(f.elements[name]){return f.elements[name];}else{return null;}}
function get_form_element_value(name,f)
{if(f==null){f=document.main_form;}
return(f.elements[name])?form_element_value(f.elements[name]):'';}
function form_element_value(element)
{if(element==null)return"";if(element.type==null)element.type=element[0].type;switch(element.type){case"select-one":if(element.selectedIndex>=0){return element.options[element.selectedIndex].value;}
break;case"select-multiple":if(element.selectedIndex>=0){var retArr=new Array();for(var i=0;i<element.options.length;i++){if(element.options[i].selected){retArr.push(element.options[i].value);}}
if(retArr.length>0){return retArr;}}
break;case"radio":if(element.length!=null){for(var i=0;i<element.length;i++){if(element[i].checked){return element[i].value;}}}else{return element.value;}
break;case"checkbox":return(element.checked)?element.value:"";break;default:if(element.length!=null&&element[0]!=null){return element[0].value;}else{return element.value;}}
return"";}
function get_combo_text(element)
{if(element.type!="select-one"&&element.type!="select-multiple")return'';return element.options[element.selectedIndex].text;}
function check_radio_button(element,field_val)
{for(var i=0;i<element.length;i++){if(element[i].value==field_val){element[i].checked=true;break;}}
return;}
function highlight_combo_value(element,field_val){if(element.type!="select-one"&&element.type!="select-multiple")return;for(var i=0;i<element.options.length;i++){if(element.options[i].value==field_val){element.options[i].selected=true;element.selectedIndex=i;break;}}}
function move_combo_selection(element,move_up)
{switch(element.type){case"select-one":if(element.selectedIndex>=0){if(move_up){if(element.selectedIndex>0){var i=element.selectedIndex;var tmp1=new Option(element.options[i-1].text,element.options[i-1].value);tmp1.selected=element.options[i-1].selected;var tmp2=new Option(element.options[i].text,element.options[i].value);tmp2.selected=element.options[i].selected;element.options[i-1]=tmp2
element.options[i]=tmp1;}}else{if(element.selectedIndex<(element.options.length-1)){var i=element.selectedIndex;var tmp1=new Option(element.options[i+1].text,element.options[i+1].value);tmp1.selected=element.options[i+1].selected;var tmp2=new Option(element.options[i].text,element.options[i].value);tmp2.selected=element.options[i].selected;element.options[i+1]=tmp2
element.options[i]=tmp1;}}}
break;case"select-multiple":if(move_up){for(var i=0;i<element.options.length;i++){if(!element.options[i].selected)continue;if(i>0&&!element.options[i-1].selected){var tmp1=new Option(element.options[i-1].text,element.options[i-1].value);tmp1.selected=element.options[i-1].selected;var tmp2=new Option(element.options[i].text,element.options[i].value);tmp2.selected=element.options[i].selected;element.options[i-1]=tmp2
element.options[i]=tmp1;}}}else{for(var i=element.options.length-1;i>-1;i--){if(!element.options[i].selected)continue;if(i<(element.options.length-1)&&!element.options[i+1].selected){var tmp1=new Option(element.options[i+1].text,element.options[i+1].value);tmp1.selected=element.options[i+1].selected;var tmp2=new Option(element.options[i].text,element.options[i].value);tmp2.selected=element.options[i].selected;element.options[i+1]=tmp2
element.options[i]=tmp1;}}}
break;default:alert(js_translate('element_not_combo_box',element.name));}}
function datetime_set_date(d,m,y,prefix)
{var units=new Array('d','m','y');for(u in units){eval('var value = '+units[u]+';');var id=prefix+'value_'+units[u];var unit=document.getElementById(id);if(unit.type=='text'){unit.value=value;}else{for(var i=0;i<unit.options.length;i++){if(value==unit.options[i].value){unit.selectedIndex=i;}}}}}
function datetime_get_ts(prefix)
{var d=new Date();if(null!==(elt=document.getElementById(prefix+'value[y]'))){d.setYear(elt.value);}
if(null!==(elt=document.getElementById(prefix+'value[m]'))){d.setMonth(elt.value-1);}
if(null!==(elt=document.getElementById(prefix+'value[d]'))){d.setDate(elt.value);}
if(null!==(elt=document.getElementById(prefix+'value[h]'))){d.setHours(elt.value);}
if(null!==(elt=document.getElementById(prefix+'value[i]'))){d.setMinutes(elt.value);}
if(null!==(elt=document.getElementById(prefix+'value[s]'))){d.setSeconds(elt.value);}
return parseInt(d.getTime()/1000);}
function createHiddenField(name,value)
{var newElt=document.createElement('INPUT');newElt.type='hidden';newElt.name=name;newElt.id=name;newElt.value=value;return newElt;}
function createTextBox(name,value,size,maxLength,className,onFocus,onBlur)
{var newElt=document.createElement('INPUT');newElt.type='text';newElt.name=name;newElt.id=name;newElt.size=size;if(maxLength>0){newElt.maxLength=maxLength;}
newElt.className=className;newElt.onfocus=new Function('',onFocus);newElt.onblur=new Function('',onBlur);return newElt;}
function createSpan(value)
{var newElt=document.createElement('SPAN');newElt.innerHTML=value;return newElt;}
function createButton(name,label,onClick)
{var newElt=document.createElement('INPUT');newElt.type='button';newElt.name=name;newElt.id=name;newElt.value=label;newElt.onclick=new Function('',onClick);return newElt;}
function addNewAssetFinder(moreButton,nameBase,safeNameBase,typeCodesString,mapFrame,doneFn,showClear)
{var next_index=0;while(document.getElementById(safeNameBase+'_'+next_index+'__label')!=null)next_index++;parentElt=moreButton.parentNode;var name=nameBase+'['+next_index+']';var safeName=safeNameBase+'_'+next_index+'_';parentElt.insertBefore(document.createElement('BR'),moreButton);parentElt.insertBefore(createHiddenField(name+'[assetid]',0),moreButton);parentElt.insertBefore(createHiddenField(name+'[url]',0),moreButton);parentElt.insertBefore(createTextBox(safeName+'_label','',20,0,'sq-form-asset-finder','this.tmp = this.value;','this.value = this.tmp;'),moreButton);var tmp_id_label=createSpan('Id : #');tmp_id_label.className='sq-asset-finder-id-label';parentElt.insertBefore(tmp_id_label,moreButton);var tmp_assetid=createTextBox(safeName+'_assetid','',2,0,'','');tmp_assetid.onchange=new Function('',mapFrame+'.asset_finder_assetid_changed(\''+name+"', '"+safeName+"', '"+typeCodesString+"', "+doneFn+",this.value);");parentElt.insertBefore(tmp_assetid,moreButton);parentElt.insertBefore(document.createTextNode(' '),moreButton);var changeButton=createButton(safeName+'_change_btn','Change',mapFrame+'.asset_finder_change_btn_press(\''+name+"', '"+safeName+"', '"+typeCodesString+"', "+doneFn+");");parentElt.insertBefore(changeButton,moreButton);if(showClear){parentElt.insertBefore(createButton(safeName+'_clear_btn','Clear',mapFrame+'.asset_finder_clear_btn_press(\''+name+'\', \''+safeName+'\');'),moreButton);}}
function disable_buttons()
{inputs=document.getElementsByTagName('input');buttons=Array();for(var i=0;i<inputs.length;i++){if((inputs[i].type=='submit')||(inputs[i].type=='button')){buttons[buttons.length]=inputs[i];}}
for(var i=0;i<buttons.length;i++){newElt=document.createElement('INPUT');newElt.type=buttons[i].type;newElt.value=buttons[i].value;if(buttons[i].className){newElt.className=buttons[i].className+' disabled';newElt.className=buttons[i].className+' loading';}
newElt.disabled='disabled';buttons[i].style.display='none';buttons[i].parentNode.insertBefore(newElt,buttons[i]);}}
function prependClearButton(elt,inherit)
{newButton=document.createElement('input');newButton.type='button';newButton.style.marginBottom='3px';newButton.value=js_translate('clear');if(inherit){newButton.onclick=new Function("resetLastSelect(this); clearLastCheckbox(this);");}else{newButton.onclick=new Function("resetLastSelect(this)");}
elt.parentNode.insertBefore(newButton,elt);}
function prependTypeSelector(elt,inherit)
{var lastSelect=elt.previousSibling;while(lastSelect.tagName!='SELECT'){lastSelect=lastSelect.previousSibling;}
elt.parentNode.insertBefore(document.createElement('br'),elt);elt.parentNode.insertBefore(lastSelect.cloneNode(true),elt);}
function prependInheritSelector(elt)
{hiddenField=elt.previousSibling;while((hiddenField.tagName!='INPUT')||(hiddenField.type.toUpperCase()!='HIDDEN')){hiddenField=hiddenField.previousSibling;}
checkbox=elt.previousSibling;while((checkbox.tagName!='INPUT')||(checkbox.type.toUpperCase()!='CHECKBOX')){checkbox=checkbox.previousSibling;}
var currentKey=checkbox.id.match(/asset_type_chooser_inherit_check_box_(\d+)/);var newKey=parseInt(currentKey[1])+1;var newID='asset_type_chooser_inherit_check_box_'+newKey;newHiddenField=hiddenField.cloneNode(true);newHiddenField.value='0';newCheckbox=checkbox.cloneNode(true);newCheckbox.checked=0;newCheckbox.id=newID;newCheckbox.name=newID;newLabel=document.createElement('label');newLabel.innerHTML='inherit &nbsp;';newLabel.htmlFor=newID;elt.parentNode.insertBefore(newHiddenField,elt);elt.parentNode.insertBefore(newCheckbox,elt);elt.parentNode.insertBefore(newLabel,elt);}
function resetLastSelect(elt)
{select=elt.previousSibling;while(select.tagName!='SELECT'){select=select.previousSibling;}
select.selectedIndex=0;}
function toggleLastHiddenField(checkbox)
{hiddenField=checkbox.previousSibling;while(!(hiddenField.tagName=='INPUT')&&(hiddenField.type.toUpperCase=='HIDDEN')){hiddenField=hiddenField.previousSibling;}
hiddenField.value=checkbox.checked?'1':'0';}
function clearLastCheckbox(elt)
{checkbox=elt.previousSibling;while((checkbox.tagName!='INPUT')||(checkbox.type.toUpperCase()!='CHECKBOX')){checkbox=checkbox.previousSibling;}
if(checkbox.checked){checkbox.click();}}
function insert_text(text,to_id)
{if(text.length==0)return;var myField=document.getElementById(to_id);var rememberScroll=myField.scrollTop;if(document.selection){myField.focus();var rng=document.selection.createRange();rng.colapse;rng.text=text;}else if(myField.selectionStart||myField.selectionStart=='0'){var startPos=myField.selectionStart;var endPos=myField.selectionEnd;myField.value=myField.value.substring(0,startPos)
+text
+myField.value.substring(endPos,myField.value.length);myField.focus();myField.selectionStart=startPos+text.length;myField.selectionEnd=startPos+text.length;}else{myField.value+=text;}
myField.scrollTop=rememberScroll;}
function sortMoveDown(currentOrder,el_prefix,order_el)
{var currentElement=document.getElementById(el_prefix+currentOrder);var nextElement=document.getElementById(el_prefix+(currentOrder+1));var form=document.getElementById('main_form');if(!nextElement||!form){return;}
if(!currentElement.innerHTML){return;}
var temp=currentElement.innerHTML;currentElement.innerHTML=nextElement.innerHTML;nextElement.innerHTML=temp;var current_order_el=eval('form.elements[\''+order_el+'['+currentOrder+']\']');var next_order_el=eval('form.elements[\''+order_el+'['+(currentOrder+1)+']\']');var temp=next_order_el.value;next_order_el.value=current_order_el.value;current_order_el.value=temp;}
function sortMoveUp(currentOrder,el_prefix,order_el)
{if(currentOrder==0)return;var currentElement=document.getElementById(el_prefix+currentOrder);var prevElement=document.getElementById(el_prefix+(currentOrder-1));var form=document.getElementById('main_form');if(!form){return;}
if(!currentElement.innerHTML){return;}
var temp=currentElement.innerHTML;currentElement.innerHTML=prevElement.innerHTML;prevElement.innerHTML=temp;var current_order_el=eval('form.elements[\''+order_el+'['+currentOrder+']\']');var prev_order_el=eval('form.elements[\''+order_el+'['+(currentOrder-1)+']\']');var temp=prev_order_el.value;prev_order_el.value=current_order_el.value;current_order_el.value=temp;}
function setAllTo(the_button,the_value)
{var parent_table=the_button;while(parent_table.tagName.toLowerCase()!='table'){parent_table=parent_table.parentNode;}
var fields=parent_table.getElementsByTagName('SELECT');for(var i=0;i<fields.length;i++){fields[i].value=the_value;if('createEvent'in document){var evt=document.createEvent('HTMLEvents');evt.initEvent('change',false,true);fields[i].dispatchEvent(evt);}else
fields[i].fireEvent('onchange');}
return false;}
var agt=navigator.userAgent.toLowerCase();var is_major=parseInt(navigator.appVersion);var is_minor=parseFloat(navigator.appVersion);var is_nav=((agt.indexOf('mozilla')!=-1)&&(agt.indexOf('spoofer')==-1)&&(agt.indexOf('compatible')==-1)&&(agt.indexOf('opera')==-1)&&(agt.indexOf('webtv')==-1)&&(agt.indexOf('hotjava')==-1));var is_nav2=(is_nav&&(is_major==2));var is_nav3=(is_nav&&(is_major==3));var is_nav4=(is_nav&&(is_major==4));var is_nav4up=(is_nav&&(is_major>=4));var is_navonly=(is_nav&&((agt.indexOf(";nav")!=-1)||(agt.indexOf("; nav")!=-1)));var is_nav6=(is_nav&&(is_major==5));var is_nav6up=(is_nav&&(is_major>=5));var is_gecko=(agt.indexOf('gecko')!=-1);var is_chrome=(agt.indexOf('chrome')>-1);var is_ie=((agt.indexOf("msie")!=-1)&&(agt.indexOf("opera")==-1));var is_ie3=(is_ie&&(is_major<4));var is_ie4=(is_ie&&(is_major==4)&&(agt.indexOf("msie 4")!=-1));var is_ie4up=(is_ie&&(is_major>=4));var is_ie5=(is_ie&&(is_major==4)&&(agt.indexOf("msie 5.0")!=-1));var is_ie5_5=(is_ie&&(is_major==4)&&(agt.indexOf("msie 5.5")!=-1));var is_ie5up=(is_ie&&!is_ie3&&!is_ie4);var is_ie5_5up=(is_ie&&!is_ie3&&!is_ie4&&!is_ie5);var is_ie6=(is_ie&&(is_major==4)&&(agt.indexOf("msie 6.")!=-1));var is_ie6up=(is_ie&&!is_ie3&&!is_ie4&&!is_ie5&&!is_ie5_5);var is_aol=(agt.indexOf("aol")!=-1);var is_aol3=(is_aol&&is_ie3);var is_aol4=(is_aol&&is_ie4);var is_aol5=(agt.indexOf("aol 5")!=-1);var is_aol6=(agt.indexOf("aol 6")!=-1);var is_opera=(agt.indexOf("opera")!=-1);var is_opera2=(agt.indexOf("opera 2")!=-1||agt.indexOf("opera/2")!=-1);var is_opera3=(agt.indexOf("opera 3")!=-1||agt.indexOf("opera/3")!=-1);var is_opera4=(agt.indexOf("opera 4")!=-1||agt.indexOf("opera/4")!=-1);var is_opera5=(agt.indexOf("opera 5")!=-1||agt.indexOf("opera/5")!=-1);var is_opera5up=(is_opera&&!is_opera2&&!is_opera3&&!is_opera4);var is_webtv=(agt.indexOf("webtv")!=-1);var is_TVNavigator=((agt.indexOf("navio")!=-1)||(agt.indexOf("navio_aoltv")!=-1));var is_AOLTV=is_TVNavigator;var is_hotjava=(agt.indexOf("hotjava")!=-1);var is_hotjava3=(is_hotjava&&(is_major==3));var is_hotjava3up=(is_hotjava&&(is_major>=3));var is_js;if(is_nav2||is_ie3)is_js=1.0;else if(is_nav3)is_js=1.1;else if(is_opera5up)is_js=1.3;else if(is_opera)is_js=1.1;else if((is_nav4&&(is_minor<=4.05))||is_ie4)is_js=1.2;else if((is_nav4&&(is_minor>4.05))||is_ie5)is_js=1.3;else if(is_hotjava3up)is_js=1.4;else if(is_nav6||is_gecko)is_js=1.5;else if(is_nav6up)is_js=1.5;else if(is_ie5up)is_js=1.3
else is_js=0.0;var is_win=((agt.indexOf("win")!=-1)||(agt.indexOf("16bit")!=-1));var is_win95=((agt.indexOf("win95")!=-1)||(agt.indexOf("windows 95")!=-1));var is_win16=((agt.indexOf("win16")!=-1)||(agt.indexOf("16bit")!=-1)||(agt.indexOf("windows 3.1")!=-1)||(agt.indexOf("windows 16-bit")!=-1));var is_win31=((agt.indexOf("windows 3.1")!=-1)||(agt.indexOf("win16")!=-1)||(agt.indexOf("windows 16-bit")!=-1));var is_winme=((agt.indexOf("win 9x 4.90")!=-1));var is_win2k=((agt.indexOf("windows nt 5.0")!=-1));var is_win98=((agt.indexOf("win98")!=-1)||(agt.indexOf("windows 98")!=-1));var is_winnt=((agt.indexOf("winnt")!=-1)||(agt.indexOf("windows nt")!=-1));var is_win32=(is_win95||is_winnt||is_win98||((is_major>=4)&&(navigator.platform=="Win32"))||(agt.indexOf("win32")!=-1)||(agt.indexOf("32bit")!=-1));var is_os2=((agt.indexOf("os/2")!=-1)||(navigator.appVersion.indexOf("OS/2")!=-1)||(agt.indexOf("ibm-webexplorer")!=-1));var is_mac=(agt.indexOf("mac")!=-1);if(is_mac&&is_ie5up)is_js=1.4;var is_mac68k=(is_mac&&((agt.indexOf("68k")!=-1)||(agt.indexOf("68000")!=-1)));var is_macppc=(is_mac&&((agt.indexOf("ppc")!=-1)||(agt.indexOf("powerpc")!=-1)));var is_sun=(agt.indexOf("sunos")!=-1);var is_sun4=(agt.indexOf("sunos 4")!=-1);var is_sun5=(agt.indexOf("sunos 5")!=-1);var is_suni86=(is_sun&&(agt.indexOf("i86")!=-1));var is_irix=(agt.indexOf("irix")!=-1);var is_irix5=(agt.indexOf("irix 5")!=-1);var is_irix6=((agt.indexOf("irix 6")!=-1)||(agt.indexOf("irix6")!=-1));var is_hpux=(agt.indexOf("hp-ux")!=-1);var is_hpux9=(is_hpux&&(agt.indexOf("09.")!=-1));var is_hpux10=(is_hpux&&(agt.indexOf("10.")!=-1));var is_aix=(agt.indexOf("aix")!=-1);var is_aix1=(agt.indexOf("aix 1")!=-1);var is_aix2=(agt.indexOf("aix 2")!=-1);var is_aix3=(agt.indexOf("aix 3")!=-1);var is_aix4=(agt.indexOf("aix 4")!=-1);var is_linux=(agt.indexOf("inux")!=-1);var is_sco=(agt.indexOf("sco")!=-1)||(agt.indexOf("unix_sv")!=-1);var is_unixware=(agt.indexOf("unix_system_v")!=-1);var is_mpras=(agt.indexOf("ncr")!=-1);var is_reliant=(agt.indexOf("reliantunix")!=-1);var is_dec=((agt.indexOf("dec")!=-1)||(agt.indexOf("osf1")!=-1)||(agt.indexOf("dec_alpha")!=-1)||(agt.indexOf("alphaserver")!=-1)||(agt.indexOf("ultrix")!=-1)||(agt.indexOf("alphastation")!=-1));var is_sinix=(agt.indexOf("sinix")!=-1);var is_freebsd=(agt.indexOf("freebsd")!=-1);var is_bsd=(agt.indexOf("bsd")!=-1);var is_unix=((agt.indexOf("x11")!=-1)||is_sun||is_irix||is_hpux||is_sco||is_unixware||is_mpras||is_reliant||is_dec||is_sinix||is_aix||is_linux||is_bsd||is_freebsd);var is_vms=((agt.indexOf("vax")!=-1)||(agt.indexOf("openvms")!=-1));var is_dom=(document.getElementById)?true:false;
function bodycopy_insert_div(bodycopy_name,divid,before){bodycopy_current_edit["bodycopy_name"]=bodycopy_name;bodycopy_current_edit["data"]=new Object();bodycopy_current_edit["data"]["containerid"]=divid;bodycopy_current_edit["data"]["container_type"]='div';bodycopy_current_edit["data"]["before"]=before;bodycopy_show_popup("insert_div.php",325,320);}
function bodycopy_save_insert_div(attributes){bodycopy_current_edit["data"]["attributes"]=attributes;bodycopy_hide_popup();bodycopy_submit("insert_container",bodycopy_current_edit["bodycopy_name"],bodycopy_current_edit["data"]);}
function bodycopy_delete_div(bodycopy_name,divid){if(confirm('Are you sure you want to delete this container?')){var data=new Object();data["containerid"]=divid;bodycopy_submit("delete_container",bodycopy_name,data);}}
function bodycopy_edit_div_properties(bodycopy_name,divid,can_delete){bodycopy_current_edit["bodycopy_name"]=bodycopy_name;bodycopy_current_edit["can_delete"]=can_delete;bodycopy_current_edit["data"]=new Object();bodycopy_current_edit["data"]["divid"]=divid;bodycopy_current_edit["data"]["available_types"]=get_bodycopy_available_content_types();bodycopy_current_edit["data"]["available_classes"]=get_bodycopy_div_available_classes();var data=get_bodycopy_current_div_data(bodycopy_name,divid);if(data!=null){bodycopy_current_edit["data"]["attributes"]=var_unserialise(data["attributes"]);}
bodycopy_show_popup("edit_div_props.php",325,557,divid,'div');}
function bodycopy_save_div_properties(attributes){bodycopy_current_edit["data"]["attributes"]=attributes;bodycopy_hide_popup();var id=bodycopy_current_edit["bodycopy_name"]+'_div_'+bodycopy_current_edit["data"]["divid"];bodycopy_chgColor(id);serialise_div(bodycopy_current_edit["bodycopy_name"],bodycopy_current_edit["data"],bodycopy_current_edit["data"]["divid"]);}
function bodycopy_edit_div_conditions(bodycopy_name,divid,parentid){bodycopy_current_edit["bodycopy_name"]=bodycopy_name;bodycopy_current_edit["data"]=new Object();bodycopy_current_edit["data"]["divid"]=divid;bodycopy_current_edit["data"]["parentid"]=parentid;bodycopy_current_edit['available_conditions']=bodycopy_available_conditions[divid];var data=get_bodycopy_current_div_data(bodycopy_name,divid);if(data!=null){bodycopy_current_edit["data"]["attributes"]=var_unserialise(data["attributes"]);}
bodycopy_show_popup("edit_div_conditions.php",325,480,divid,'div');}
function setInputsEnabled(parent,enabled)
{var inputs=parent.getElementsByTagName('INPUT');for(var i=0;i<inputs.length;i++){inputs[i].disabled=!enabled;}
var selects=parent.getElementsByTagName('SELECT');for(var i=0;i<selects.length;i++){selects[i].disabled=!enabled;}}
function in_array(elt,ar)
{for(var i=0;i<ar.length;i++){if(ar[i]==elt)return true;}
return false;}
function setSelection(prefix,values,selected)
{var select=document.getElementById(prefix);if((select!==null)&&(typeof select.options!="undefined")){for(var i=0;i<select.options.length;i++){if(in_array(select.options[i].value,values)){select.options[i].selected=selected;}}}else{for(var i=0;i<values.length;i++){var obj=document.getElementById(prefix+'_'+values[i]);if(null===obj){alert(prefix+'_'+values[i]+' is null!');}
if(obj.tagName=='OPTION'){obj.selected=selected;}
if((obj.tagName=='INPUT')&&(obj.type=='checkbox'||obj.type=='radio')){obj.checked=selected;}}}}
function handleDefaultClick(defaultCheckbox,prefix,default_vals,non_default_vals)
{if(defaultCheckbox.checked){setSelection(prefix,default_vals,true)
setSelection(prefix,non_default_vals,false);}
setInputsEnabled(document.getElementById(prefix+'_field'),!defaultCheckbox.checked);}
function setInputsEnabled(parent,enabled)
{var inputs=parent.getElementsByTagName('INPUT');for(var i=0;i<inputs.length;i++){inputs[i].disabled=!enabled;}
var selects=parent.getElementsByTagName('SELECT');for(var i=0;i<selects.length;i++){selects[i].disabled=!enabled;}}
function handleDefaultClickMT(defaultCheckbox,prefix,default_vals)
{var inputs=document.getElementById(prefix+'_field').getElementsByTagName('INPUT');if(defaultCheckbox.checked){for(i=0;i<default_vals.length;i++){if(i==inputs.length-1){expandOptionList(inputs[i]);inputs=document.getElementById(prefix+'_field').getElementsByTagName('INPUT');}
inputs[i].value=default_vals[i];}
for(;i<inputs.length;i++){inputs[i].value='';}}
setInputsEnabled(document.getElementById(prefix+'_field'),!defaultCheckbox.checked);}
function setHierarchyInputsEnabled(prefix,parent,default_box,cascade_box,enabled)
{var inputs=parent.getElementsByTagName('INPUT');for(var i=0;i<inputs.length;i++){var matched=inputs[i].name.search(prefix);if(matched!=-1){inputs[i].disabled=!enabled;}
if(inputs[i].name===default_box||inputs[i].name===cascade_box){inputs[i].disabled=false;}}
var selects=parent.getElementsByTagName('SELECT');for(var i=0;i<selects.length;i++){var matched=selects[i].name.search(prefix);if(matched!=-1){selects[i].disabled=!enabled;}}}
function in_array(elt,ar)
{for(var i=0;i<ar.length;i++){if(ar[i]==elt)return true;}
return false;}
function setSelectionHierarchy(prefix,keys,default_values,drill,selected)
{var select=document.getElementById(prefix);if((select!==null)&&(typeof select.options!="undefined")){if(drill){if(selected){select.options.length=0;for(var i=0;i<keys.length;i++){if(typeof default_values[i]!=='undefined'&&default_values[i]!==null){var text=keys[i]+'. '+default_values[i];}else{var text=keys[i];}
select.options[select.options.length]=new Option(text,keys[i]);select.options[i].selected=true;}}else{for(var i=0;i<select.options.length;i++){select.options[i].selected=false;}}}else{for(var i=0;i<select.options.length;i++){if(in_array(select.options[i].value,keys)){select.options[i].selected=selected;}}}}else{for(var i=0;i<keys.length;i++){var obj=document.getElementById(prefix+'_'+keys[i]);if(null===obj){alert(prefix+'_'+keys[i]+' is null!');}
if(obj.tagName=='OPTION'){obj.selected=selected;}
if((obj.tagName=='INPUT')&&(obj.type=='checkbox'||obj.type=='radio')){obj.checked=selected;}}}}
function handleDefaultClickHierarchy(defaultCheckbox,prefix,default_keys,default_values,non_default_keys,drill_down)
{if(defaultCheckbox.checked){setSelectionHierarchy(prefix,default_keys,default_values,drill_down,true);if(!drill_down){setSelectionHierarchy(prefix,non_default_keys,default_values,drill_down,false);}}else{if(drill_down){setSelectionHierarchy(prefix,default_keys,default_values,drill_down,false);}}
setHierarchyInputsEnabled(prefix,document.getElementById(prefix+'_field'),prefix+'_default',prefix+'_cascade_value',!defaultCheckbox.checked);}